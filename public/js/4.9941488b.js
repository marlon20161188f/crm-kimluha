(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"18d2":function(t,e,a){"use strict";a.r(e);var s=a("ded3"),o=a.n(s),i=a("2d18"),r=a("c759"),l={name:"StateForm",props:["showDialog","recordId"],data:()=>({loading:!1,loadingSubmit:!1,resource:"api/state",title:"",errors:{},form:{},colors:[]}),created(){this.initForm(),this.initTables()},methods:{initForm(){this.title="",this.errors={},this.form={id:null,name:"",description:"",color_id:null}},initTables(){this.$axios.get(`/${this.resource}/tables`).then((t=>{this.colors=t.data.colors}))},async handleOpen(){this.loading=!0,this.initForm(),this.recordId?(await this.$axios.get(`/${this.resource}/record/${this.recordId}`).then((t=>{this.form=t.data.data})),this.title="Editar estado"):this.title="Nuevo estado",this.loading=!1},async onSubmit(){this.loading=!0,this.loadingSubmit=!0,this.errors={},await this.$axios.post(`/${this.resource}`,this.form).then((t=>{t.data.success?(this.$q.notify({message:t.data.message,icon:"fas fa-check",color:"positive"}),this.$emit("success",t.data.id),this.closeDialog()):this.$q.notify({message:t.data.message,icon:"fas fa-times",color:"red"})})).catch((t=>{this.errors=t})),this.loadingSubmit=!1,this.loading=!1},closeDialog(){this.$emit("update:showDialog",!1)}}},n=a("2877"),c=a("24e8"),d=a("f09f"),u=a("a370"),p=a("0016"),m=a("eb85"),f=a("ddd8"),h=a("66e5"),b=a("4074"),g=a("58a81"),v=a("0170"),w=a("cb32"),_=a("9c40"),q=a("eebe"),C=a.n(q),x=Object(n.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{attrs:{value:t.showDialog,"no-esc-dismiss":!1,"no-backdrop-dismiss":!0,"transition-show":"scale","transition-hide":"scale"},on:{"before-show":t.handleOpen,hide:t.closeDialog}},[a("q-card",{staticClass:"x-dialog",staticStyle:{width:"480px"}},[a("q-card-section",[a("div",{staticClass:"flex justify-between items-center"},[a("div",{staticClass:"x-dialog--title"},[t._v(t._s(t.title))]),a("div",[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"far fa-times-circle",size:"md"},on:{click:function(e){return e.preventDefault(),t.closeDialog.apply(null,arguments)}}})],1)])]),a("q-separator"),a("q-card-section",[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-24 col-md-12"},[a("x-input",{attrs:{label:"Nombre del estado",error:t.errors.name},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("div",{staticClass:"col-24 col-md-12"},[a("q-select",{attrs:{outlined:"",dense:"","options-dense":"",options:t.colors,"option-value":"id","option-label":"name","emit-value":"","map-options":"","stack-label":"",label:"Color"},scopedSlots:t._u([{key:"option",fn:function(e){return[a("q-item",t._g(t._b({},"q-item",e.itemProps,!1),e.itemEvents),[a("q-item-section",{attrs:{avatar:""}},[a("q-badge",{style:{"background-color":e.opt.color},attrs:{rounded:""}})],1),a("q-item-section",[a("q-item-label",{domProps:{innerHTML:t._s(e.opt.name)}})],1)],1)]}},{key:"selected-item",fn:function(e){return[a("q-badge",{staticClass:"q-mr-md",style:{"background-color":e.opt.color},attrs:{rounded:""}}),t._v(" "+t._s(e.opt.name)+"\n")]}}]),model:{value:t.form.color_id,callback:function(e){t.$set(t.form,"color_id",e)},expression:"form.color_id"}})],1),a("div",{staticClass:"col-24"},[a("x-input",{attrs:{label:"Descripción",error:t.errors.description},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)]),a("div",{staticClass:"col-24 text-right",staticStyle:{"margin-top":"18px"}},[a("q-btn",{staticClass:"q-mr-md",attrs:{outline:"",color:"blue"},on:{click:function(e){return e.preventDefault(),t.closeDialog.apply(null,arguments)}}},[t._v("CANCELAR")]),a("q-btn",{attrs:{unelevated:"",color:"blue",loading:t.loadingSubmit},on:{click:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[t.recordId?[t._v("GUARDAR CAMBIOS")]:[t._v("CREAR")]],2)],1)]),a("x-loading",{attrs:{loading:t.loading}})],1)],1)}),[],!1,null,null,null),y=x.exports;C()(x,"components",{QDialog:c.a,QCard:d.a,QCardSection:u.a,QIcon:p.a,QSeparator:m.a,QSelect:f.a,QItem:h.a,QItemSection:b.a,QBadge:g.a,QItemLabel:v.a,QAvatar:w.a,QBtn:_.a});var S=a("2f62"),k={name:"ConfigurationIndex",components:{StateForm:y,XCardTable:i.a,XTableServer:r.a},data:()=>({load:!1,loading:!1,loadingSubmit:!1,showDialogState:!1,showDialogLock:!1,resourceState:"api/state",tabActive:"state",reloadRecords:!1,errors:{},form:{},roles:[],recordId:null,profile:{}}),mounted(){this.load=!0,this.user&&"operator"!==this.user.role_id?this.tabActive="state":this.tabActive="information",this.getProfileTable(),this.getProfile()},computed:o()({},Object(S.d)("auth",["user"])),methods:{initForm(){this.profile={}},initProfile(){this.profile={}},clickCreateState(t){this.recordId=t,this.showDialogState=!0},clickLock(t){this.showDialogLock=!0},async getProfileTable(){this.loading=!0,await this.$axios.get("/api/auth/profile/tables").then((t=>{this.roles=t.data.roles})),this.loading=!1},async getProfile(){this.loading=!0,await this.$axios.get("/api/auth/profile").then((t=>{this.profile=t.data.data})),this.loading=!1},async updateProfile(){this.loading=!0,this.loadingSubmit=!0,this.errors={},await this.$axios.post("/api/auth/profile",this.profile).then((t=>{t.data.success?this.$q.notify({message:t.data.message,icon:"fas fa-check",color:"positive"}):this.$q.notify({message:t.data.message,icon:"fas fa-times",color:"red"})})).catch((t=>{this.errors=t})),this.loadingSubmit=!1,this.loading=!1},async updatePassword(){this.loading=!0,this.loadingSubmit=!0,this.errors={},await this.$axios.post("/api/auth/update_password",this.form).then((t=>{t.data.success?(this.initProfile(),this.$q.notify({message:t.data.message,icon:"fas fa-check",color:"positive"})):this.$q.notify({message:t.data.message,icon:"fas fa-times",color:"red"})})).catch((t=>{this.errors=t})),this.loadingSubmit=!1,this.loading=!1}}},$=a("429b"),A=a("7460"),D=a("adad"),Q=a("823b"),R=a("bd08"),I=a("db86"),T=Object(n.a)(k,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.load?a("div",{staticClass:"content-index"},[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-24"},[a("x-card-table",{attrs:{title:"CONTACTOS"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",{staticClass:"flex justify-between items-center"},[a("q-tabs",{attrs:{"active-color":"blue"},model:{value:t.tabActive,callback:function(e){t.tabActive=e},expression:"tabActive"}},[t.user&&"operator"!==t.user.role_id?a("q-tab",{attrs:{name:"state",label:"ESTADOS"}}):t._e(),a("q-tab",{attrs:{name:"information",label:"MIS DATOS"}}),a("q-tab",{attrs:{name:"password",label:"CAMBIAR CONTRASEÑA"}})],1),"state"===t.tabActive&&t.user&&"operator"!==t.user.role_id?a("q-btn",{attrs:{unelevated:"",color:"blue"},on:{click:function(e){return e.preventDefault(),t.clickCreateState()}}},[t._v("CREAR\n              ESTADO\n            ")]):t._e()],1)]},proxy:!0},{key:"table",fn:function(){return[a("q-tab-panels",{attrs:{animated:"","keep-alive":""},model:{value:t.tabActive,callback:function(e){t.tabActive=e},expression:"tabActive"}},[a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"state"}},[a("x-table-server",{attrs:{resource:t.resourceState,"show-header":!1,"show-filter":!1,"reload-records":t.reloadRecords},on:{"update:reloadRecords":function(e){t.reloadRecords=e},"update:reload-records":function(e){t.reloadRecords=e}},scopedSlots:t._u([{key:"table-rows",fn:function(e){var s=e.props;return[a("q-tr",{attrs:{props:s}},[t._l(s.cols,(function(e){return[a("q-td",{key:e.name,attrs:{props:s}},["actions"===e.name?[a("q-btn",{attrs:{size:"sm",flat:"",round:"",icon:"fas fa-eye"},on:{click:function(e){return e.preventDefault(),t.clickCreateState(s.row.id)}}})]:"color"===e.name?[a("q-badge",{style:{"background-color":s.row.color},attrs:{rounded:""}})]:[t._v("\n                          "+t._s(s.row[e.name])+"\n                        ")]],2)]}))],2)]}}],null,!1,1555445217)})],1),a("q-tab-panel",{attrs:{name:"information"}},[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"DNI",error:t.errors.number},model:{value:t.profile.number,callback:function(e){t.$set(t.profile,"number",e)},expression:"profile.number"}})],1),a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"Nombre",error:t.errors.name},model:{value:t.profile.name,callback:function(e){t.$set(t.profile,"name",e)},expression:"profile.name"}})],1),a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"Apellido",error:t.errors.lastname},model:{value:t.profile.lastname,callback:function(e){t.$set(t.profile,"lastname",e)},expression:"profile.lastname"}})],1),a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"Email",error:t.errors.email},model:{value:t.profile.email,callback:function(e){t.$set(t.profile,"email",e)},expression:"profile.email"}})],1),a("div",{staticClass:"col-24 col-md-8"},[a("x-select",{attrs:{label:"Perfil",readonly:!0,options:t.roles,error:t.errors.role_id},model:{value:t.profile.role_id,callback:function(e){t.$set(t.profile,"role_id",e)},expression:"profile.role_id"}})],1)]),a("div",{staticClass:"row q-col-gutter-md",staticStyle:{"margin-top":"18px"}},[a("div",{staticClass:"col-24 text-right"},[a("q-btn",{attrs:{unelevated:"",color:"blue",loading:t.loadingSubmit},on:{click:function(e){return e.preventDefault(),t.updateProfile.apply(null,arguments)}}},[t._v("GUARDAR\n                    CAMBIOS\n                  ")])],1)])]),a("q-tab-panel",{attrs:{name:"password"}},[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"Contraseña actual",error:t.errors.password},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"Nueva contraseña",error:t.errors.password_new},model:{value:t.form.password_new,callback:function(e){t.$set(t.form,"password_new",e)},expression:"form.password_new"}})],1),a("div",{staticClass:"col-24 col-md-8"},[a("x-input",{attrs:{label:"Repetir contraseña",error:t.errors.password_new_2},model:{value:t.form.password_new_2,callback:function(e){t.$set(t.form,"password_new_2",e)},expression:"form.password_new_2"}})],1)]),a("div",{staticClass:"row q-col-gutter-md",staticStyle:{"margin-top":"18px"}},[a("div",{staticClass:"col-24 text-right"},[a("q-btn",{attrs:{unelevated:"",color:"blue",loading:t.loadingSubmit},on:{click:function(e){return e.preventDefault(),t.updatePassword.apply(null,arguments)}}},[t._v("GUARDAR CAMBIOS\n                  ")])],1)])])],1)]},proxy:!0}],null,!1,3165099558)})],1)]),a("state-form",{attrs:{"show-dialog":t.showDialogState,"record-id":t.recordId},on:{"update:showDialog":function(e){t.showDialogState=e},"update:show-dialog":function(e){t.showDialogState=e},success:function(e){t.reloadRecords=!0}}})],1):t._e()}),[],!1,null,null,null);e.default=T.exports,C()(T,"components",{QTabs:$.a,QTab:A.a,QBtn:_.a,QTabPanels:D.a,QTabPanel:Q.a,QTr:R.a,QTd:I.a,QBadge:g.a})},"2d18":function(t,e,a){"use strict";var s={name:"XCardTable",props:{title:{type:String,default:"Sin título"}},methods:{}},o=(a("feb1"),a("2877")),i=a("f09f"),r=a("a370"),l=a("eebe"),n=a.n(l),c=Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{attrs:{flat:""}},[a("q-card-section",{staticClass:"x-card-table--header"},[t._t("header")],2),a("q-card-section",{staticClass:"q-pt-none q-pl-none q-pr-none"},[t._t("table")],2)],1)}),[],!1,null,"efc2fe2a",null);e.a=c.exports,n()(c,"components",{QCard:i.a,QCardSection:r.a})},c759:function(t,e,a){"use strict";var s={name:"XTableServer",props:{title:{type:String,default:""},resourceInit:{default:null},resource:{type:String,required:!0},showHeader:{type:Boolean,default:!0},showFilter:{type:Boolean,default:!1},showButtonNew:{type:Boolean,default:!0},reloadRecords:{type:Boolean,default:!1}},data:()=>({filter:"",loading:!1,columns:[],filters:[],records:[],pagination:{sortBy:null,descending:null,page:1,rowsPerPage:10,rowsNumber:10}}),watch:{reloadRecords:{handler(t){t&&(this.getRecords({pagination:this.pagination,filters:this.filters}),this.$emit("update:reloadRecords",!1))},deep:!0}},async mounted(){await this.getInitTable(),await this.getRecords({pagination:this.pagination,filters:this.filters})},methods:{async getInitTable(){this.loading=!0;let t=this.resourceInit?this.resourceInit:this.resource;await this.$axios.get(`/${t}/init_data_table`).then((t=>{this.columns=t.data.columns,this.filters=t.data.filters})),this.loading=!1},async getRecords(t){const{page:e,rowsPerPage:a,sortBy:s,descending:o}=t.pagination,i=(t.filters,0===a?this.pagination.rowsNumber:a);this.loading=!0,this.records=[],await this.$axios.post(`/${this.resource}/records`,{isPagination:!0,page:e,limit:i,sortBy:s,descending:o,filters:this.filters}).then((t=>{this.records=t.data.data,this.pagination.page=t.data.meta.current_page,this.pagination.rowsPerPage=t.data.meta.per_page,this.pagination.rowsNumber=t.data.meta.total,this.pagination.sortBy=t.data.meta.sort_by,this.pagination.descending=t.data.meta.descending})),this.loading=!1},async changeFilter(){await this.getRecords({pagination:this.pagination,filters:this.filters})},clickCreate(t){this.$emit("click-create",t)}}},o=a("2877"),i=a("f09f"),r=a("a370"),l=a("9c40"),n=a("ddd8"),c=a("27f9"),d=a("0016"),u=a("eaac"),p=a("eebe"),m=a.n(p),f=Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticClass:"q-px-md",attrs:{flat:""}},[t.showHeader?a("q-card-section",{staticClass:"q-px-none q-pb-none"},[a("div",{staticClass:"flex justify-between items-center"},[a("div",{staticClass:"text-h6"},[t._v(t._s(t.records.length)+" "+t._s(t.title))]),a("div",{staticClass:"flex items-center"},[t._t("button-actions"),t.showButtonNew?a("q-btn",{attrs:{unelevated:"",color:"blue"},on:{click:function(e){return e.preventDefault(),t.clickCreate()}}},[t._v("Nuevo")]):t._e()],2)])]):t._e(),t.showFilter?a("q-card-section",{staticClass:"q-px-none q-pt-md q-pb-none"},[a("div",{staticClass:"row q-col-gutter-x-sm q-col-gutter-y-sm"},[t._l(t.filters,(function(e){return["select"===e.type?a("div",{class:e.class},[a("q-select",{staticClass:"select-truncate",attrs:{label:e.label,options:e.options,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",dense:"","options-dense":""},on:{input:t.changeFilter},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"f.value"}})],1):t._e(),"input"===e.type?a("div",{class:e.class},[a("q-input",{attrs:{label:e.label,outlined:"",dense:""},on:{input:t.changeFilter},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"fas fa-search",size:"xs"}})]},proxy:!0}],null,!0),model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"f.value"}})],1):t._e()]}))],2)]):t._e(),a("q-card-section",{staticClass:"q-px-none q-pt-lg q-pb-none"},[a("q-table",{staticClass:"table-index",attrs:{data:t.records,columns:t.columns,loading:t.loading,pagination:t.pagination,flat:"","row-key":"id","binary-state-sort":""},on:{"update:pagination":function(e){t.pagination=e},request:t.getRecords},scopedSlots:t._u([{key:"body",fn:function(e){return[t._t("table-rows",null,{props:e})]}}],null,!0)})],1)],1)}),[],!1,null,null,null);e.a=f.exports,m()(f,"components",{QCard:i.a,QCardSection:r.a,QBtn:l.a,QSelect:n.a,QInput:c.a,QIcon:d.a,QTable:u.a})},fcc9:function(t,e,a){},feb1:function(t,e,a){"use strict";a("fcc9")}}]);
